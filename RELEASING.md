# =======================================================
# Процес створення релізу (на прикладі версії X.Y.Z)
# =======================================================

# Приклад: випускаємо версію 1.1.0. Замінюємо X.Y.Z на 1.1.0

# -------------------------------------------------------
# Крок 1: Підготовка. Переконайтесь, що 'develop' актуальний
# -------------------------------------------------------
# Переключаємось на гілку для розробки
git checkout develop

# Завантажуємо останні зміни з сервера
git pull origin develop


# -------------------------------------------------------
# Крок 2: Створення релізної гілки
# -------------------------------------------------------
# Створюємо нову гілку для релізу з develop
# Наприклад: git checkout -b release/1.1.0
git checkout -b release/X.Y.Z


# -------------------------------------------------------
# Крок 3: Оновлення версії та CHANGELOG
# -------------------------------------------------------
# На цьому етапі ви ВРУЧНУ редагуєте файли:
# 1. `app/build.gradle.kts`: змініть `majorVersion`, `minorVersion`, `patchVersion`
# 2. `CHANGELOG.md`: Перейменуйте секцію [Unreleased] на [X.Y.Z] - YYYY-MM-DD
#    і додайте зверху нову порожню секцію [Unreleased].

# Після редагування, додаємо ці зміни в Git і робимо коміт
git add app/build.gradle.kts CHANGELOG.md
git commit -m "chore: Bump version to X.Y.Z"


# -------------------------------------------------------
# Крок 4: Злиття релізу в `main`
# -------------------------------------------------------
# Переключаємось на головну, стабільну гілку
git checkout main

# (Опціонально, але бажано) Переконуємось, що main теж актуальна
git pull origin main

# Зливаємо нашу релізну гілку в main.
# Прапор `--no-ff` створює merge-коміт, навіть якщо можливий fast-forward.
# Це зберігає історію релізів чистою та зрозумілою.
git merge --no-ff release/X.Y.Z


# -------------------------------------------------------
# Крок 5: Створення тегу для версії
# -------------------------------------------------------
# Створюємо анотований тег на останньому коміті в main (який і є нашим релізом)
# Наприклад: git tag -a v1.1.0 -m "Release version 1.1.0"
git tag -a vX.Y.Z -m "Release version X.Y.Z"


# -------------------------------------------------------
# Крок 6: Злиття релізу назад в `develop`
# -------------------------------------------------------
# Переключаємось назад на гілку розробки
git checkout develop

# Зливаємо релізну гілку, щоб оновити номер версії і CHANGELOG в develop
git merge --no-ff release/X.Y.Z


# -------------------------------------------------------
# Крок 7: Відправка змін на GitHub
# -------------------------------------------------------
# Відправляємо оновлені гілки main та develop
git push origin main
git push origin develop

# ВАЖЛИВО: відправляємо теги окремою командою
git push origin --tags


# -------------------------------------------------------
# Крок 8: Очистка
# -------------------------------------------------------
# Релізна гілка більше не потрібна, її можна видалити
git branch -d release/X.Y.Z

# Якщо потрібно видалити і віддалену релізну гілку (якщо ви її туди пушили):
# git push origin --delete release/X.Y.Z
# =======================================================
